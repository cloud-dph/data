<!DOCTYPE html>
<html>
<head>
    <title>Authentication</title>
    <style>
        body {
            font-family: sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f0f0;
        }

        .container {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        input[type="tel"],
        input[type="password"],
        input[type="text"] {
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 250px;
            box-sizing: border-box;
        }

        button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        button:hover {
            background-color: #0056b3;
        }

        .error-message {
            color: red;
            margin-top: 5px;
        }

        #dp-carousel-container {
            overflow-x: auto;
            margin-bottom: 15px;
            padding: 10px 0;
        }

        #dp-carousel {
            display: flex;
            gap: 10px;
            width: fit-content; /* Adjust width based on the number of DPs */
            margin: 0 auto; /* Center the carousel */
        }

        .dp-option {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            background-size: cover;
            background-position: center;
        }

        .dp-option.selected {
            border-color: #007bff;
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/9.x.x/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.x.x/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.x.x/firebase-firestore-compat.js"></script>
</head>
<body>
    <div class="container">
        <div id="mobile-input-section">
            <h2>Enter Mobile Number</h2>
            <input type="tel" id="mobileNumber" placeholder="Mobile Number">
            <button onclick="checkMobileNumber()">Continue</button>
            <p id="mobile-error" class="error-message"></p>
        </div>

        <div id="login-section" style="display: none;">
            <h2>Enter Password</h2>
            <input type="password" id="password" placeholder="Password">
            <button onclick="loginUser()">Login</button>
            <p id="login-error" class="error-message"></p>
        </div>

        <div id="signup-section" style="display: none;">
            <h2>Sign Up</h2>
            <div id="dp-carousel-container">
                <div id="dp-carousel">
                    </div>
            </div>
            <input type="text" id="name" placeholder="Your Name">
            <input type="password" id="signupPassword" placeholder="Password">
            <button onclick="signupUser()">Sign Up</button>
            <p id="signup-error" class="error-message"></p>
        </div>
    </div>

    <script>
        const dpData = [
          { id: 'dp1', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/19.png', alt: 'Profile Picture 1', aiHint: 'abstract pattern' },
          { id: 'dp2', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/9.png', alt: 'Profile Picture 2', aiHint: 'geometric design' },
          { id: 'dp3', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/24.png', alt: 'Profile Picture 3', aiHint: 'nature illustration' },
          { id: 'dp4', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/v1/feature/profile/27.png', alt: 'Profile Picture 4', aiHint: 'minimalist graphic' },
          { id: 'dp5', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/8.png', alt: 'Profile Picture 5', aiHint: 'colorful design' },
          { id: 'dp6', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/4.png', alt: 'Profile Picture 6', aiHint: 'superhero mask' },
          { id: 'dp7', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/26.png', alt: 'Profile Picture 7', aiHint: 'man portrait' },
          { id: 'dp8', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/15.png', alt: 'Profile Picture 8', aiHint: 'penguin cartoon' },
          { id: 'dp9', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/23.png', alt: 'Profile Picture 9', aiHint: 'woman portrait' },
          { id: 'dp10', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/10.png', alt: 'Profile Picture 10', aiHint: 'helmet character' },
          { id: 'dp11', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/7.png', alt: 'Profile Picture 11', aiHint: 'smiley face gradient' },
          { id: 'dp12', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/6.png', alt: 'Profile Picture 12', aiHint: 'panda cartoon' },
          { id: 'dp13', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/1.png', alt: 'Profile Picture 13', aiHint: 'woman cartoon' },
          { id: 'dp14', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/25.png', alt: 'Profile Picture 14', aiHint: 'man mustache' },
          { id: 'dp15', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/17.png', alt: 'Profile Picture 15', aiHint: 'lion cub' },
          { id: 'dp16', url: 'https://img1.hotstarext.com/image/upload/w_200,h_200,c_fill/feature/profile/13.png', alt: 'Profile Picture 16', aiHint: 'panther mask' }
        ];

        // Initialize Firebase (replace with your actual config)
        const firebaseConfig = {
          apiKey: "AIzaSyDvKhzHTcSmj3Z64oePRGP2TeEd_5A4RVU",
  authDomain: "authentication-c6c71.firebaseapp.com",
  projectId: "authentication-c6c71",
  storageBucket: "authentication-c6c71.firebasestorage.app",
  messagingSenderId: "707906547881",
  appId: "1:707906547881:web:55c67cf3e7e867951c39b8",
  measurementId: "G-ZKY9SXX8N8"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore(); // Or firebase.database() for Realtime Database

        const mobileInputSection = document.getElementById('mobile-input-section');
        const loginSection = document.getElementById('login-section');
        const signupSection = document.getElementById('signup-section');
        const mobileNumberInput = document.getElementById('mobileNumber');
        const passwordInput = document.getElementById('password');
        const signupPasswordInput = document.getElementById('signupPassword');
        const nameInput = document.getElementById('name');
        const dpCarousel = document.getElementById('dp-carousel');
        const mobileError = document.getElementById('mobile-error');
        const loginError = document.getElementById('login-error');
        const signupError = document.getElementById('signup-error');

        let selectedDPUrl = dpData[0].url; // Default selected DP URL

        function populateDPCarousel() {
            dpCarousel.innerHTML = '';
            dpData.forEach((dp, index) => {
                const img = document.createElement('div');
                img.classList.add('dp-option');
                img.style.backgroundImage = `url('${dp.url}')`;
                img.addEventListener('click', () => {
                    document.querySelectorAll('.dp-option').forEach(el => el.classList.remove('selected'));
                    img.classList.add('selected');
                    selectedDPUrl = dp.url;
                });
                if (index === 0) {
                    img.classList.add('selected');
                }
                dpCarousel.appendChild(img);
            });
        }

        populateDPCarousel();

        async function checkMobileNumber() {
            const mobileNumber = mobileNumberInput.value;
            mobileError.textContent = '';

            // Basic mobile number validation (you might need more robust validation)
            if (!/^\d{10}$/.test(mobileNumber)) {
                mobileError.textContent = 'Invalid mobile number.';
                return;
            }

            try {
                // Check if a user with this mobile number exists in your Firebase database
                const usersRef = db.collection('users'); // Assuming you have a 'users' collection
                const querySnapshot = await usersRef.where('mobile', '==', mobileNumber).get();

                if (!querySnapshot.empty) {
                    // Mobile number exists, show login section
                    mobileInputSection.style.display = 'none';
                    loginSection.style.display = 'block';
                    // Store the mobile number for login
                    loginSection.dataset.mobile = mobileNumber;
                } else {
                    // Mobile number doesn't exist, show signup section
                    mobileInputSection.style.display = 'none';
                    signupSection.style.display = 'block';
                    // Store the mobile number for signup
                    signupSection.dataset.mobile = mobileNumber;
                }
            } catch (error) {
                console.error("Error checking mobile number:", error);
                mobileError.textContent = 'An error occurred. Please try again.';
            }
        }

        async function loginUser() {
            const mobileNumber = loginSection.dataset.mobile;
            const password = passwordInput.value;
            loginError.textContent = '';

            try {
                // In a real application, you would typically use Firebase Authentication
                // with email/password or phone number authentication.
                // For this simplified example, we'll query the database.
                const usersRef = db.collection('users');
                const querySnapshot = await usersRef.where('mobile', '==', mobileNumber).get();

                if (!querySnapshot.empty) {
                    const userDoc = querySnapshot.docs[0];
                    const userData = userDoc.data();
                    // In a real scenario, you would compare a hashed password
                    if (userData.password === password) {
                        console.log('Login successful!');
                        window.location.href = 'abc.xyz';
                    } else {
                        loginError.textContent = 'Incorrect password.';
                    }
                } else {
                    loginError.textContent = 'User not found.'; // Should not happen if checkMobileNumber worked correctly
                }
            } catch (error) {
                console.error("Error logging in:", error);
                loginError.textContent = 'An error occurred. Please try again.';
            }
        }

        async function signupUser() {
            const mobileNumber = signupSection.dataset.mobile;
            const password = signupPasswordInput.value;
            const name = nameInput.value;
            signupError.textContent = '';

            // Basic password validation
            if (password.length < 6) {
                signupError.textContent = 'Password must be at least 6 characters long.';
                return;
            }

            try {
                // Store user data in Firestore
                await db.collection('users').doc().set({ // You might want to use mobile number as document ID
                    mobile: mobileNumber,
                    password: password, // In a real app, hash the password!
                    name: name,
                    dpURL: selectedDPUrl
                });
                console.log('Signup successful!');
                window.location.href = 'abc.xyz';
            } catch (error) {
                console.error("Error signing up:", error);
                signupError.textContent = 'An error occurred during signup.';
            }
        }
    </script>
</body>
</html>
