<!-- see.html -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>View Movie</title>
  <style>
    body { font-family: Arial; max-width: 600px; margin: 2rem auto; }
    img { max-width: 100%; }
  </style>
</head>
<body>
  <h2>Movie Data Viewer</h2>
  <div id="output">Loading...</div>

  <!-- Firebase Setup -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBROgYUR-2rakUxHbl90JlynP_X3f0GxIM",
      authDomain: "diseny-plus-hotstar-database.firebaseapp.com",
      projectId: "diseny-plus-hotstar-database",
      storageBucket: "diseny-plus-hotstar-database.firebasestorage.app",
      messagingSenderId: "582861150339",
      appId: "1:582861150339:web:0d2b69a2ae914342b723b6",
      measurementId: "G-HX223WNVKE"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function getQueryParams() {
      const params = new URLSearchParams(window.location.search);
      const [code, type] = (params.get("code") || "").split("/");
      return { code, type };
    }

    const { code, type } = getQueryParams();

    db.collection("movies").doc(code).get().then(doc => {
      if (!doc.exists) {
        document.getElementById('output').innerText = "No movie found.";
        return;
      }

      const movie = doc.data();
      let content = "";

      switch (type) {
        case "image":
          content = `<h3>Image</h3><img src="${movie.imageUrl}" alt="Image">`; break;
        case "logo":
          content = `<h3>Logo</h3><img src="${movie.logoUrl}" alt="Logo">`; break;
        case "description":
          content = `<h3>Description</h3><p>${movie.description}</p>`; break;
        case "poster":
          content = `<h3>Poster</h3><img src="${movie.posterUrl}" alt="Poster">`; break;
        case "genres":
          content = `<h3>Genres</h3><p>${movie.genres}</p>`; break;
        case "tags":
          content = `<h3>Tags</h3><p>${movie.tags}</p>`; break;
        case "redirect":
          content = `<h3>Redirect</h3><a href="${movie.redirectUrl}" target="_blank">${movie.redirectUrl}</a>`; break;
        default:
          content = `<h3>All Data</h3><pre>${JSON.stringify(movie, null, 2)}</pre>`;
      }

      document.getElementById('output').innerHTML = content;
    });
  </script>
</body>
</html>
