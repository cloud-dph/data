<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Movie Preview</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #000;
      color: #fff;
    }

    #movie-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #banner {
      width: 100%;
      height: 250px;
      object-fit: cover;
      position: relative;
    }

    .overlay {
      position: absolute;
      top: 180px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 2;
    }

    #logo {
      height: 80px;
    }

    .content {
      padding: 16px;
      width: 100%;
      box-sizing: border-box;
    }

    #name {
      font-size: 24px;
      margin-bottom: 8px;
    }

    #year {
      color: #ccc;
      margin-bottom: 16px;
    }

    button {
      padding: 12px 20px;
      background-color: #e50914;
      border: none;
      color: white;
      font-size: 16px;
      margin-bottom: 20px;
      border-radius: 5px;
      cursor: pointer;
    }

    p {
      margin: 8px 0;
      font-size: 14px;
      line-height: 1.5;
    }
  </style>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
</head>
<body>

  <div id="movie-container">
    <img id="banner" src="" alt="Movie Banner" />
    <div class="overlay">
      <img id="logo" src="" alt="Logo" />
    </div>
    <div class="content">
      <h1 id="name">Movie Title</h1>
      <p id="year">2025 • U • Hindi</p>
      <button id="watchBtn">▶ Watch Now</button>
      <p id="description">Movie description goes here...</p>
      <p><strong>Genres:</strong> <span id="genres"></span></p>
      <p><strong>Tags:</strong> <span id="tags"></span></p>
    </div>
  </div>

  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyBROgYUR-2rakUxHbl90JlynP_X3f0GxIM",
      authDomain: "diseny-plus-hotstar-database.firebaseapp.com",
      projectId: "diseny-plus-hotstar-database",
      storageBucket: "diseny-plus-hotstar-database.firebasestorage.app",
      messagingSenderId: "582861150339",
      appId: "1:582861150339:web:0d2b69a2ae914342b723b6",
      measurementId: "G-HX223WNVKE"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Get code from URL
    const params = new URLSearchParams(window.location.search);
    const code = params.get('code');

    if (code) {
      db.collection("movies").doc(code).get().then((doc) => {
        if (doc.exists) {
          const data = doc.data();
          document.getElementById("banner").src = data.imageUrl || "";
          document.getElementById("logo").src = data.logoUrl || "";
          document.getElementById("name").textContent = data.Name || "Untitled";
          document.getElementById("genres").textContent = data.genres || "";
          document.getElementById("tags").textContent = data.tags || "";
          document.getElementById("description").textContent = data.description || "";

          document.getElementById("watchBtn").onclick = () => {
            if (data.redirectUrl) {
              window.location.href = data.redirectUrl;
            } else {
              alert("No redirect URL available.");
            }
          };
        } else {
          alert("Movie not found.");
        }
      }).catch((error) => {
        console.error("Error fetching movie:", error);
        alert("Failed to load movie.");
      });
    } else {
      alert("No code provided in URL.");
    }
  </script>
</body>
</html>
